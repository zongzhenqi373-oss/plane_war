#                                **/\*\*\*\*飞\*\*\*机\*\*\*大\*\*\*战\*\*\*更\*\*\*新\*\*\*版\*\*\*\*/**

#### /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*基于课上的飞机大战游戏做了如下更新：\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

#### **概述：**

##### **1，增加关卡，根据分数来更新关卡，第一关只有小型敌人飞机，一个小型敌人飞机1分，达到20分进入第二关（会有弹窗提示：进入第2关）；第二关会增加中型敌人飞机，根据概率来生成，中型敌人飞机一个2分，达到70分进入第三关，产生大型敌人飞机，依旧根据概率来生成，大型敌人飞机一个4分，达到120分进入第四关；第四关会调整敌人飞机的创建频率。/\*目前只写到第四关，并且会将分数和关卡一起显示到左上角\*/**

##### **2，增加道具，分别有护盾和子弹增强道具，护盾道具从第二关开始掉落，每吃一个护盾道具玩家血量增加1（这块用增加碰撞次数来反映出来）；子弹增强道具从第三关开始掉落，每吃一个子弹威力就增强1（这块用子弹打击敌人飞机对敌人飞机造成的伤害+1来反映出来）；每个道具都只有10秒钟的效果持续时间。/\*目前只引入两个道具，玩家血量和火力值都会显示在右下角\*/**

##### **3，增加游戏背景音乐，在初始化的时候增加背景音乐，增加游戏趣味性。/\*子弹射出的声音和爆炸声音我也加了，但是总是被覆盖，没有解决\*/**



##### 一，关卡设置：程序中定义了一个关卡类 Level ，文件包含Level.h和Level.cpp，下面是详细说明：

&nbsp;	**1，Level 类说明：**

Level 类主要负责 游戏关卡的管理，包括关卡配置、当前关卡状态维护以及根据玩家得分自动升级到下一关。它为整个游戏提供关卡数据支持，是游戏逻辑的重要核心之一。

&nbsp;	**2，主要功能：**

（1）关卡配置管理

&nbsp;	在构造函数中预定义了所有关卡的配置，包括：scoreThreshold：进入下一关所需的累计分数；enemySpawnInterval：敌机生成的时间间隔（毫秒）；smallPlaneRatio：小型敌机出现概率；midPlaneRatio：中型敌机出现概率；bigPlaneRatio：大型敌机出现概率。

（2）获取当前关卡配置

&nbsp;	提供 getCurrentLevelConfig() 方法，用于获取当前关卡的详细配置，供其他模块调用。其他模块不需要关心关卡内部实现，只需要读取配置即可。

（3）自动升级关卡

&nbsp;	提供 updateLevel(int score) 方法，通过判断玩家得分是否达到当前关卡的阈值，自动升级到下一关。随着关卡的提升，敌机数量增加、刷新速度加快，难度逐步提升。

&nbsp;	**3，在游戏中的作用：**

（1）敌机生成系统会读取当前关卡配置，决定敌机类型与刷新频率；

（2）道具掉落概率也可以根据关卡配置动态调整；

（3）当玩家得分足够时，Level 会自动提升关卡，从而驱动整个游戏难度逐渐提升。

##### 二，道具设置：程序中定义了一个基类Item，用于统一管理道具ShieldItem和BulletItem，分别是护盾以及子弹威力增强，Item文件包含，Item.h, Item.cpp, ShieldItem.h, ShieldItem.cpp, BulletItem.h, BulletItem.cpp；同时增加了一个道具工厂ItemFactory，用工厂模式来创建道具，方便PlaneApp.cpp调用。下面是详细说明：

	**1，Item类说明：**

Item 类是游戏中 所有道具的抽象基类，用于统一管理道具的基本属性和行为。在游戏中，道具是玩家击落敌机后或随机掉落的物体，玩家拾取后会获得特殊效果，例如护盾或子弹增强等。该类采用了 多态 + 工厂模式 设计，保证扩展性强，能够方便地添加新的道具类型。

	**2，主要功能：**

（1）定义道具的基本属性。包括IMAGE m\_img：道具的图像资源；int m\_x、int m\_y：道具在游戏画布上的坐标；；random\_device rd：用于生成随机位置，使道具在屏幕顶部随机掉落。

（2）定义道具行为。包括init()：初始化道具，包括加载图片、设置初始坐标等；show()：将道具展示到游戏窗口；isHitPlayer(Player\* player)：判断玩家是否拾取了该道具；move(int step)：控制道具下落；isOutOfScreen()：判断道具是否超出屏幕范围，用于清理无效的道具。

（3）多态支持。

&nbsp;	Item 是一个 纯虚基类（抽象类），不能直接实例化；所有具体道具（包括ShieldItem、BulletItem）都必须继承 Item 并实现自己的 init()、show()、isHitPlayer() 方法，保证了游戏逻辑中可以通过基类指针统一管理不同类型的道具。

&nbsp;	**3，在游戏中的作用：**

（1）道具工厂通过工厂模式创建不同道具对象，返回 Item\*

（2）PlaneApp 在游戏循环中管理所有道具：调用 move() 让道具下落；调用 show() 绘制道具；检测 isHitPlayer()，处理拾取效果；超出屏幕则通过 isOutOfScreen() 移除。

##### 三，模块程序更新

&nbsp;	**1，游戏模块更新：**

（1）新增三个定时器：//定时自动关闭关卡提示弹窗 ::SetTimer(m\_hwnd, 8, 1500, nullptr);     //每次进入一个关卡后，都会有弹窗提醒，但是为了不影响玩家游戏，必须设置定时器来定时关闭这个弹窗

&nbsp;				     //定时检测道具 ::SetTimer(m\_hwnd, 9, 10, nullptr);                               //定时对玩家是否拾取道具进行检测，如果拾取相关道具，就要产生相应效果

&nbsp;				     //定时创建道具 ::SetTimer(m\_hwnd, 10, 3000, nullptr);                         //定时创建道具，随机创建

（2）新增一个分数累加函数：AddScore(Foe\* foe)；在定时器5中，根据爆炸飞机的类型来进行分数的累加；代替之前不论什么飞机分数都只加1的情况。

（3）新增道具效果显示窗口：showItem()；定义变量玩家火力和护盾数量，初始化火力值为1，每次吃到一个子弹增强伤害火力就+1；初始化护盾数量为0，玩家血量等于初始化血量1+护盾数量。

（4）碰撞效果：玩家飞机撞到到了敌人飞机，如果血量自减1不为0，那么就回到初始化位置；如果为0，那么结束游戏。

&nbsp;	**2，玩家信息更新：**增加血量值m\_blood，初始化为1

&nbsp;     **3，敌人飞机更新：**新增函数getSize()；获取当前敌人飞机的类型，根据类型方便后续分数增加。



























